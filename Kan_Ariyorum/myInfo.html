<!DOCTYPE html>

<html>
    <head>
        <title></title>
       
    </head>
    <body>
        <div data-role="view" id="secondview" data-init="viewStart" data-layout="mobile-view" data-title="Bilgilerim">
            <ul data-role="listview" data-style="inset" data-type="group">
                <li>
                    Kullanıcı Bilgileri
                    <ul>
                        <li data-icon="contacts">İsim Soyisim : <label style="float:right"   id="lblNameSurname">asd</label></li>
                        <li data-icon="contacts">Dogum Tarihi : <label style="float:right" id="lblDogumYili">asd</label></li>
                        <li data-icon="contacts">Cinsiyet : <label style="float:right" id="lblCinsiyet">asd</label></li>
                        <li data-icon="contacts">Kan Grubu : <label style="float:right" id="lblKan">asd</label></li>
                        <li data-icon="contacts">Uygunluk : <input id="avaibility-switch" /></li>
                    </ul>
                </li>
                <li>
                    Ayarlar
                    <ul id="buttonsLi">
                        <li data-icon="compose" id="btnDuzenle" data-click="btnDuzenleClicked"><a data-click="btnDuzenleClicked"  data-role="detailbutton">Düzenle</a></li>
                        <li data-icon="delete"><a>Kullanıcıyı Uygulamadan Kaldır</a></li>
                    </ul>
                </li>
            </ul>
        </div>    
        
        
    <div data-role="layout" data-id="mobile-view">
    <footer data-role="footer">
        <div data-role="navbar" id="km-navbar">
            <a class="nav-button" data-align="left" data-role="backbutton">Geri</a>
            <span data-role="view-title">Bilgilerim</span>
        </div>
    </footer>
    </div>
        
    <script>
        function viewStart(){

            $('#buttonsLi').kendoTouch({
            filter: ">li",
            tap: btnDuzenleClicked

        });
            var dId = window.localStorage.getItem("DonorId");
            if(dId!=null)
                getDonorSettings(dId);
            
            mobileSwitchInit();
        }
        function btnDuzenleClicked(e)
        {
            //alert($(e.touch.currentTarget).data('icon'W));
            if($(e.touch.currentTarget).data('icon')=="delete")
            {
                window.localStorage.clear();
                alert('Kullanıcı silindi');
                navigator.app.exitApp();
                return;
            }
            else
            {
            global.isEditing = true;
            app.navigate(
                    'register.html#register-listview',
                    'slide:right'
                );
            }
       }
        
        function mobileSwitchInit() {

            $("#avaibility-switch").kendoMobileSwitch({
                checked: true,
                onLabel: "Evet",
                offLabel: "Hayır",
                change:function(e){
                    var id = window.localStorage.getItem('DonorId');
                    if(id==null)return;
                    var url = "http://kanariyorum.azurewebsites.net/api/DonorStatus/" + id;
                    var options = {
                        type: "PUT",
                        url: url,
                        contentType: "application/json",  
                    };
                    if(!e.checked)
                    {
                        options.type="DELETE";
                    }
                    $.ajax(options);
                    
                }
            });
        }
    </script>
    </body>
    
    
    
</html>
